<div class="topbar">
    <div [(ngModel)]="showLast10" ngbRadioGroup name="showLast10" (ngModelChange)="updateData()">
        <label class="btn btn-primary"><input type="radio" [value]="true">Last 10</label>
        <label class="btn btn-primary"><input type="radio" [value]="false">All</label>
    </div>
</div>

<table class="results table table-bordered table-condensed">
    <thead>
        <tr>
            <th>#</th>
            <th class="datecolumn">Datum</th>
            <th class="notecolumn">Bemerkung</th>
            <th *ngFor="let par of metricsService.course.pars; let holeIndex = index" class="throws">{{holeIndex + 1}}</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let metricName of metricsService.metricNames">
            <td colspan="3">{{metricName}}</td>
            <td *ngFor="let par of metricsService.course.pars; let holeIndex = index" class="throws">
                {{metricsService.byHoleMetric[metricName][holeIndex] | number:'1.0-1'}}
            </td>
        </tr>
        <tr *ngFor="let round of metricsService.rounds; let roundIndex = index">
            <td>{{roundIndex + 1 + showOffset}}</td>
            <ng-template [ngIf]="editingRound?.originalRoundIndex !== roundIndex">
                <td>{{round.date | date:'dd.MM.yyyy'}}</td>
                <td>{{round.note}}</td>
                <td *ngFor="let par of metricsService.course.pars; let holeIndex = index" [style.backgroundColor]="colorMapService.colorMap[roundIndex][holeIndex]"
                    class="throws">
                    {{round.throws[holeIndex]}}
                </td>
                <td>
                    <ng-template [ngIf]="!editingRound">
                        <div class="btn btn-primary" (click)="startEditing(roundIndex)">
                            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                        </div>
                        <div class="btn btn-primary" (click)="removeRound(roundIndex)">
                            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                        </div>
                    </ng-template>
                </td>
            </ng-template>
            <ng-template [ngIf]="editingRound?.originalRoundIndex === roundIndex">
                <td>
                    <input class="form-control" placeholder="yyyy-mm-dd" name="dp" [(ngModel)]="editingRound.round.date" (navigate)="onDateChanged($event)"
                        ngbDatepicker #d="ngbDatepicker">
                    <div class="input-group-addon" (click)="d.toggle()">
                        <img src="img/calendar-icon.svg" style="width: 1.2rem; height: 1rem; cursor: pointer;" />
                    </div>
                </td>
                <td class="notecolumn"><input type="text" [(ngModel)]="editingRound.round.note" /></td>
                <td *ngFor="let par of metricsService.course.pars; let holeIndex = index" class="throws">
                    <input type="number" [(ngModel)]="editingRound.round.throws[holeIndex]" />
                </td>
                <td>
                    <div class="btn btn-primary" (click)="finishEditing(roundIndex)"><span class="glyphicon glyphicon-ok"></span></div>
                    <div class="btn btn-primary" (click)="cancelEditing(roundIndex)"><span class="glyphicon glyphicon-remove"></span></div>
                </td>
            </ng-template>
        </tr>
        <tr *ngIf="!editingRound">
            <td colspan="3"></td>
            <td [attr.colspan]="metricsService.course.pars.length"></td>
            <td>
                <div class="btn btn-primary" (click)="startCreating()"><span class="glyphicon glyphicon-plus"></span></div>
            </td>
        </tr>
    </tbody>
</table>